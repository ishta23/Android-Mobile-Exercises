<!DOCTYPE html>
<!--
Created using JS Bin
http://jsbin.com

Copyright (c) 2016 by anonymous (http://jsbin.com/qomelapeko/1/edit)

Released under the MIT license: http://jsbin.mit-license.org
-->
<meta name="robots" content="noindex">
<html>
<head>
<meta name="description" content="Random scatterplot">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
   <script src="https://d3js.org/d3.v3.min.js"></script>
  <title>CS 424 - D3 examples</title>
</head>
<body>
<div id="left" style="float: left"> </div>
  <div id="right" style="float:right"></div>


<script id="jsbin-javascript">

var svg = d3.select("body").append("svg")
    .attr("width", "500")
    .attr("height", "500");

var g = svg.append("g");
var wImg = 200;
var hImg =300;

var img = g.append("svg:image")
    .attr("xlink:href", "https://image.freepik.com/free-icon/battery-with-a-bolt-symbol_318-62272.png")
    .attr("width", wImg)
    .attr("height", hImg)
    .attr("x", 0)
    .attr("y",0);

var ourData = [
  {"a":"joe","b":100},
  {"a":"indra","b":200},
];

console.log(ourData);

const ypos = 100;
//Green Rectangle
svg.append("rect")
    .attr("x", 45)
    .attr("y", hImg-225)
    .attr("zindex",10)
    .attr("width", 110)
    .attr("height", 70)
    .attr("fill"," #5BC236")
    .on("mouseover", OnMouseoverFruit)
    //.on("mouseover", function() {
      //      d3.select(this)
        //      .attr("fill", "red");
        //})
    .on("mouseout", function() {
            d3.select(this).attr("fill","#5BC236");
            });
  

svg.append("text")
    .text( "> 5sec")
    .attr("text-anchor", "middle")
    .attr("alignment-baseline","central")
    .attr("x",95)
    .attr("y",hImg-190)
    .attr("zindex",-10)
    .attr("font-family", "helvetica")
    .attr("font-size", "20px")
    .attr("fill", "black");

    
svg.append("rect")
    .attr("x", 45)
    .attr("y", hImg-155)
    .attr("zindex",10)
    .attr("width", 110)
    .attr("height", 96)
    .attr("fill","  #FFCC00")
    //.on("mouseover", function() {
           // d3.select(this)
            //  .attr("fill", "red");
        //})
    .on("mouseover", OnMouseoverVeg)
    .on("mouseout", function() {
            d3.select(this).attr("fill","#FFCC00");
            });
     

svg.append("text")
    .text( "< 5sec")
    .attr("text-anchor", "middle")
    .attr("alignment-baseline","central")
    .attr("x",95)
    .attr("y",hImg-120)
    .attr("zindex",-10)
    .attr("font-family", "helvetica")
    .attr("font-size", "20px")
    .attr("fill", "black");

 var diameter = 500; //max size of the bubbles
   var color    = d3.scale.category20b(); //color category

var svg2 = d3.select("body")
        .append("svg")
        .attr("width", diameter)
        .attr("height", diameter)
        //.attr("transform", "translate(" + 20 + "," + 30 + ")")
        .attr("class", "bubble");
d3Queue.queue()
    .defer(d3.csv, 'fruit.csv')
    .defer(d3.csv, 'veg.csv')
    .await(Start);
var fruitArr=[];
var vegArr= [];
function Start(error, fruit, veg)
{
    if(error) console.log(error);
     //convert numerical values from strings to numbers
        fruitArr = fruit.map(function(d){ d.value = +d["Amount"]; return d; });
        vegArr = veg.map(function(d){ d.value = +d["Amount"]; return d; });
        console.log(fruitArr);
        console.log(vegArr);
}

function update(data) {
  var t = d3.transition()
      .duration(750);

  // JOIN new data with old elements.
  var text = g.selectAll("text")
    .data(data, function(d) { return d; });

  // EXIT old elements not present in new data.
  text.exit()
      .attr("class", "exit")
    .transition(t)
      .attr("y", 60)
      .style("fill-opacity", 1e-6)
      .remove();

  // UPDATE old elements present in new data.
  text.attr("class", "update")
      .attr("y", 0)
      .style("fill-opacity", 1)
    .transition(t)
      .attr("x", function(d, i) { return i * 32; });

  // ENTER new elements present in new data.
  text.enter().append("text")
      .attr("class", "enter")
      .attr("dy", ".35em")
      .attr("y", -60)
      .attr("x", function(d, i) { return i * 32; })
      .style("fill-opacity", 1e-6)
      .text(function(d) { return d; })
    .transition(t)
      .attr("y", 0)
      .style("fill-opacity", 1);
}
function OnMouseoverFruit(d,i) 
{
   //your code here
   console.log("hello");
   d3.select(this).attr("fill", "red");
  
    var bubble = d3.layout.pack()
        .sort(null)
        .size([diameter, diameter])
        .padding(1.5);

    d3.csv("fruit.csv", function(error, data){

        //convert numerical values from strings to numbers
        data = data.map(function(d){ d.value = +d["Amount"]; return d; });
        console.log(data);
        //bubbles needs very specific format, convert data to this.
        var nodes = bubble.nodes({children:data}).filter(function(d) { return !d.children; });

        //setup the chart
        var bubbles = svg2.append("g")
            .attr("transform", "translate(0,0)")
            .selectAll(".bubble")
            .data(nodes)
            .enter(); //

        //create the bubbles
        bubbles.append("circle")
            .attr("r", function(d){ return d.r; })
            .attr("cx", function(d){ return d.x; })
            .attr("cy", function(d){ return d.y; })
            .style("fill", function(d) { return color(d.value); });

        //format the text for each bubble
        bubbles.append("text")
            .attr("x", function(d){ return d.x; })
            .attr("y", function(d){ return d.y + 5; })
            .attr("text-anchor", "middle")
            .text(function(d){ return d["Fruit"]; })
            .style({
                "fill":"white", 
                "font-family":"Helvetica Neue, Helvetica, Arial, san-serif",
                "font-size": "12px"
            });
});
   //a. hide current visualization
  
   //b. show the bubble sort visualization
   // - you can also use the keyword "this" here to get the *current* element in your data - i.e., the one you've just moused over.
}
function OnMouseoverVeg(d,i) 
{
   //your code here
   console.log("hello");
   d3.select(this).attr("fill", "red");
  
    var bubble = d3.layout.pack()
        .sort(null)
        .size([diameter, diameter])
        .padding(1.5);

    d3.csv("veg.csv", function(error, data){

        //convert numerical values from strings to numbers
        data = data.map(function(d){ d.value = +d["Amount"]; return d; });
        console.log(data);
        //bubbles needs very specific format, convert data to this.
        var nodes = bubble.nodes({children:data}).filter(function(d) { return !d.children; });

        //setup the chart
        var bubbles = svg2.append("g")
            .attr("transform", "translate(0,0)")
            .selectAll(".bubble")
            .data(nodes)
            .enter(); //

        //create the bubbles
        bubbles.append("circle")
            .attr("r", function(d){ return d.r; })
            .attr("cx", function(d){ return d.x; })
            .attr("cy", function(d){ return d.y; })
            .style("fill", function(d) { return color(d.value); });

        //format the text for each bubble
        bubbles.append("text")
            .attr("x", function(d){ return d.x; })
            .attr("y", function(d){ return d.y + 5; })
            .attr("text-anchor", "middle")
            .text(function(d){ return d["Veg"]; })
            .style({
                "fill":"white", 
                "font-family":"Helvetica Neue, Helvetica, Arial, san-serif",
                "font-size": "12px"
            });
});
   //a. hide current visualization
  
   //b. show the bubble sort visualization
   // - you can also use the keyword "this" here to get the *current* element in your data - i.e., the one you've just moused over.
}
function figureOutX(d,i) {

   d3.select(this).attr("fill", "red");
   //your code here that returns an integer value (for the x position),
   //e.g., based on some value in your "d" data object or its index position "i"
}
 
function figureOutY(d,i) {
   //your code here that returns an integer value (for the y position)
   //e.g., based on some value in your "d" data object or its index position "i"
}

</script>
</body>
</html>